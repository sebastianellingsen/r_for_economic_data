---
title: "R for Economic Data Labs"
subtitle: ""
author: "Sebastian Ellingsen"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: [default, metropolis-fonts, ninjutsu]
    nature:
      ratio: 16:9
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{css, eval = TRUE, echo = FALSE}
.remark-code{line-height: 1.5; font-size: 80%}

@media print {
  .has-continuation {
    display: block;
  }
}

code.r.hljs.remark-code{
  position: relative;
  overflow-x: hidden;
}


code.r.hljs.remark-code:hover{
  overflow-x:visible;
  width: 500px;
  border-style: solid;
}
```



# R for Economic Data Labs


This is a document that collects the commands we have used in R so far in the course. 

--

As the course progresses we will extend this list. 

--

It also presents a walk through of the R scripts from all the labs so far.

---



# Style guide

To make the scripts understandable for other people and for yourself in the future, it is important to follow a few principles when writing code.

- Add comments in scripts. This is done with a $\texttt{#}$. R will ignore anything that comes after a $\texttt{#}$.

- Names should be descriptive and meaningful. 

- Use underscore to separate words in a variable name of several words, not spaces.

- Add line breaks and avoid very long lines. 

- Variable and function names should be written in lowercase. 

- Avoid using names that are the same as existing variables.

- Add spacing between symbols such as $\texttt{+}$, $\texttt{=}$, and $\texttt{-}$.

- Verically align some repetitive coding tasks.


---



# Libraries in R

- To install a library in R use $\texttt{install.packages("library name")}$. This typically only needs to be done once during this course. To update the library, you can use the same command.

- To load a library in R use $\texttt{library(library name)}$. This needs to be done every time you load commands from a library.

- It is good practice to only load the packages you need for each session. The reason is that some packages have the same function names. In this case, you need to specify from which package the function is from. This is done with $\texttt{library name::function name}$.

- $\texttt{readr}$ has functionality for importing standard data formats in a convenient way. 

- $\texttt{readxl}$ has functions for importing data stored in Excel.

- $\texttt{tidyverse}$ has several functions that are convenient for working with data.

---




# General functions

- $\texttt{%>%}$ is a function from the $\texttt{tidyverse}$ package. It tells R that we are referring to an object we have defined on a line above.

- $\texttt{<-}$ is an assignment operator in R. You can assign an object to a name. For example, if you want to create a variable $\texttt{x}$ that takes the value $3$, you can write $\texttt{x <- 3}$. From our labs, we have seen how we can assign a plot or a dataset to a variable name as well. 

- Addition: $\texttt{+}$, subtraction: $\texttt{-}$, multiplication: $\texttt{*}$, division: $\texttt{/}$.

- Vectors are constructed using $\texttt{c()}$ (for concatenate). Ex: $\texttt{v <- c(1,2,3)}$.

- $\texttt{ifelse(statement, if true, if false)}$ creates an indicator variable.


---



# Cleaning data

- $\texttt{read_csv()}$ opens csv files in R.

- $\texttt{read_excel()}$ opens excel files in R. 

- $\texttt{select()}$ selects columns in a dataset.

- $\texttt{filter()}$ selects rows in a dataset.

- $\texttt{rename()}$ renames columns in a dataset.

- $\texttt{mutate()}$ create a new column in a dataset.

- $\texttt{lag( ,n = 1)}$ lags a variable $\texttt{n}$ rows.


---






# Plotting data 

- $\texttt{ggplot()}$ is a command for plotting data.

- $\texttt{geom_line()}$ connects a line between your data points.

- $\texttt{geom_point()}$ plots the data points.

- $\texttt{geom_bar()}$ plots a bar chart.


















---
class: inverse, middle, center



# Computer Lab 1





---


```{r, include = F}
# This is the recommended set up for flipbooks
# you might think about setting cache to TRUE as you gain practice --- building flipbooks from scratch can be time consuming
knitr::opts_chunk$set(fig.width = 6, message = FALSE, warning = FALSE, comment = "", cache = F)
library(flipbookr)
library(tidyverse)
library(readxl)

## Loading data 
mpd2020 <- read_excel("mpd2020.xlsx", sheet = 4, skip = 1) %>% 
  dplyr::select(year, GBR) %>% 
  filter(year >= 1400) %>% 
  rename(gdppc = GBR)
```


`r chunk_reveal("chunk_1")`

```{r chunk_1, include = FALSE}
# Loading packages 
library(tidyverse)
library(readxl)

# Loading and cleaning the data  
read_excel("mpd2020.xlsx", sheet = 4, skip = 1) %>% 
  dplyr::select(year, GBR) %>% 
  filter(year >= 1400) %>% 
  rename(gdppc = GBR)
```




---




`r chunk_reveal("chunk_2")`

```{r chunk_2, include = FALSE}
## Plotting the hockey stick graph
ggplot(data = mpd2020, aes(x = year, y = gdppc))+
  geom_line(lwd = 0.6) +
    xlab("Year") +
  ylab("GDP per capita")+
  labs(title = "GDP per capita, United Kingdom 1400 - 2018",
       subtitle = "Real GDP per capita in 2011 dollars",
       caption = "Source: Maddison Project Database (MPD) 2020")+
  theme(plot.title = element_text(size=12))+
  theme(plot.subtitle = element_text(size=9))+
  theme(plot.caption = element_text(size=6))+
  theme(axis.title = element_text(size = 11))+
  theme(strip.background = element_blank())+
  theme(axis.line.x = element_line(size = 0.28, colour = "black"))+
  theme(axis.line.y = element_line(size = 0.28, colour = "black"))+
  theme(strip.placement = "outside")+
  theme(panel.grid.minor = element_line('grey', size = 0.1))+
  theme(panel.grid.major = element_line('grey', size = 0.1))+
  theme(legend.position = "none")+
  theme(text=element_text(family="Palatino"))+
  theme(panel.background = element_rect(fill = "transparent", colour = NA))+
  theme(plot.background = element_rect(fill = "transparent", colour = NA))+
  scale_x_continuous(n.breaks=8) +
  scale_y_continuous(n.breaks=8)
```








